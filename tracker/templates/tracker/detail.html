<html>
    <head>
        <style>
        .homicidepage {
            font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
            border-collapse: collapse;
            width: 100%;
        }
        .homicidepage table {
            margin-left:auto; 
            margin-right:auto;
        } 
        .homicidedetails {
            border: 1px solid black;
            font-size: 0.75em; 
        }

        .listview {
            height:30%; 
            overflow:auto;
        }
        .listview td, .listview th {
            border: 1px solid #ddd;
            padding: 8px;
        }
        .listview tr:nth-child(even){background-color: #f2f2f2;}
        .listview tr:hover {background-color: #ddd;}
        .listview th {
            padding-top: 12px;
            padding-bottom: 12px;
            text-align: left;
            background-color: #A93226;
            color: white;
        }

        .details {
            table-layout: fixed; 
        }
        .details th, .details td {
            padding-top: 0px;
            padding-bottom: 0px;
        }
        .details th {
            text-align: left;
            width: 200px;
            background-color: #F2D7D5;
            color: black;
        }

        .articles {
            font-size: .8em; 
            table-layout: fixed; 
            width: 80%;
        }
        .articles th {
            padding-top: 12px;
            padding-bottom: 12px;
            text-align: left;
            background-color: rgb(175, 125, 112);
            color: white;
        }
        .articles td, .articles th {
            border: 1px solid tan;
            padding: 8px;
        }
        .articles a:link { color: rgb(253, 255, 119) }
        .articles a:visited { color: rgb(236, 234, 230) }

        .tooltip {
            position: relative;
            display: inline-block;
            border-bottom: 1px dotted black; /* If you want dots under the hoverable text */
        }
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 120px;
            background-color: black;
            color: #fff;
            text-align: center;
            padding: 5px 0;
            border-radius: 6px;
            
            /* Position the tooltip text - see examples below! */
            position: absolute;
            z-index: 1;
        }
        .tooltip:hover .tooltiptext {
             visibility: visible;
        }
        </style>

        <script type="text/javascript" >
            var geocoder;
            var map;
            var addresses = [];

            {% if homicide %}
                addresses.push(' {{ homicide.street }} ');
            {% else %}
            {% endif %}

            function initialize() {
                geocoder = new google.maps.Geocoder();
                var latlng = new google.maps.LatLng(35.2251855,-80.8415298);
                var myOptions = {
                    zoom: 10,
                    center: latlng,
                    mapTypeControl: true,
                    mapTypeControlOptions: {
                        style: google.maps.MapTypeControlStyle.DROPDOWN_MENU
                    },
                    navigationControl: true,
                    mapTypeId: google.maps.MapTypeId.ROADMAP
                };
                        
                map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
                for (i in addresses) { 
                    console.log('addrs:', addresses[i]);
                    geocoder.geocode({
                        'address': addresses[i]
                        }, function(results, status) {
                            if (status == google.maps.GeocoderStatus.OK) {
                                if (status != google.maps.GeocoderStatus.ZERO_RESULTS) {
                                    console.log('results: ', results[0].geometry.location);
                                    var marker = new google.maps.Marker({
                                        position: results[0].geometry.location,
                                        map: map,
                                        title: results[0].formatted_address,
                                    });
                                    var infowindow = new google.maps.InfoWindow({
                                        content: results[0].formatted_address,
                                        size: new google.maps.Size(150, 50)
                                    });
                                    marker.addListener('click', function() {
                                        infowindow.open(map, marker);
                                    });
                                } else {
                                    console.log("No results found for: " + addresses[i]);
                                }
                            } else {
                                console.log("Geocode was not successful for the following reason: " + status);
                            }
                        }
                    );
                }
                google.maps.event.addDomListener(window, 'load', initialize);
            }
        </script>                
        <script type="text/javascript" src="//maps.google.com/maps/api/js?sensor=false&key=AIzaSyBN-SLv7YPAMARDo2eQl7Y_yyy84xpWcHU"></script>
    </head>
    <body onload="initialize()">       
        <div class='homicidepage'>
            <h1 style="text-align: center; font-family:'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif">
                    Homicide: Life on the Street in Charlotte - 2019</h1>
        
            <div class='menu' style="text-align: center">
                [ <div class='tooltip'>
                    <a href="/homicide">Home</a>
                    <span class='tooltiptext'>Homepage</span>
                </div> | 
                <div class='tooltip'>
                        <a href="/chart">Analytics/Charts</a>
                        <span class='tooltiptext'>Analytics/Charts</span>
                    </div> | 
                <div class='tooltip'>
                        <a href="/map">Maps</a>
                        <span class='tooltiptext'>View Map of all Homicides</span>
                </div> ]
            </div>
            

            <div class='listview'>
                <table >
                    <tr>
                        <th>Seq</th>
                        <th>Date</th>
                        <th>Heading</th>
                        <th>Gender</th>
                        <th>Street</th>
                    </tr>
                    {% if h_list %}
                        {% for item in h_list %}
                            <tr>
                                <td> {{item.count}}</td>
                                <td> {{item.date}}</td>
                                <td><a href="/homicide/{{ item.id }}">{{ item.street}} - {{item.date}} - {{item.gender }}</a> </td>
                                <td> {{item.gender}}</td>
                                <td> {{item.street}}</td>
                            </tr>
                        {% endfor %}
                    {% else %}
                            <tr>
                                <p>No homicides are available.</p>            
                            </tr>
                    {% endif %}
                </table>
            </div>
            <div style="width:100%; text-align: center; font-size:.5em; height: 10px; background-color: whitesmoke;">
                <div class='tooltip'>
                    <span style="color: rgba(137, 144, 150, 0.699)">Expand/Collapse</span> 
                    <span class='tooltiptext'>Coming Soon</span>
                </div>
            </div>
            {% if homicide %}
            <div class='details'>
                <table>
                    <tr>
                        <td>
                            <table>
                                <tr><th>Number/Count:</th><td> {{ homicide.count }}</td></tr>
                                <tr><th>Street:</th><td> {{ homicide.street }}</td></tr>
                                {% if homicide.intersection %}
                                    <tr><th>Intersection:</th><td> {{ homicide.intersection }}</td></tr>
                                {% endif %}
                                {% if homicide.zipcode %}
                                    <tr><th>Zipcode:</th><td> {{ homicide.zipcode }}</td></tr>
                                {% endif %}
                                <tr><th>Date:</th><td> {{ homicide.date }}</td></tr>
                                <tr><th>Name:</th><td> {{ homicide.name }}</td></tr>
                                <tr><th>Gender:</th><td> {{ homicide.get_gender_display }}</td> </tr>
                                <tr><th>Ethnicity:</th><td> {{ homicide.get_ethnicity_display }}</td>  </tr>
                                <tr><th>Time:</th><td> {{ homicide.time }}</td>  </tr>
                                <tr><th>Means:</th><td> {{ homicide.get_means_display }}</td>  </tr>
                                <tr><th>Reason:</th><td> {{ homicide.get_motive_display }}</td>  </tr>
                                <tr><th>Location:</th><td> {{ homicide.get_location_display }}</td>  </tr>
                                <tr><th>Culprit Name:</th><td> {{ homicide.killername }}</td></tr>                    
                                <tr><th>Culprit Age:</th><td> {{ homicide.killerage }}</td></tr>                    
                                <tr><th>Culprit Ethnicity:</th><td> {{ homicide.get_killerethnicity_display }}</td></tr>                    
                                <tr><th>Culprit Gender:</th><td> {{ homicide.get_killergender_display }}</td></tr>                    
                            </table>
                        </td>
                        <td width="400px" height="300px">
                            Map {% if homicide.mapiframe %}
                                <table class="mapview">
                                    {% autoescape off %}
                                    {{ homicide.mapiframe }}
                                    {% endautoescape %}
                                </table>
                                {% else %}
                                    <div id="map_canvas" style="width:90%; height:90%"></div>
                                {% endif %}
                        </td>
                    </tr>
                </table>
                <div style="width:100%; height: 10px; background-color: whitesmoke;"></div>
                <table class='articles'>
                    <tr style="border: none; padding: 0px">
                        <td colspan=2>News Articles References</td>
                    </tr>
                    {% for a in homicide.get_articles %}
                    <tr>
                        <th><a target=_blank href='{{a.url}}'>{{ a.headline }}</a></th><td>{{ a.url }}</td>
                    {% empty %}
                        <th></th><td>No Articles </td>
                    {% endfor %}
                    </tr>
                </table>
            </div>
        </div>
        <div style="font-size: 0.7em; text-align: center">
            (c) 2019 
        </div>
        {% else %}
        {% endif %}
    </body>
</html>
